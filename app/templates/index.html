{% from 'macros/page_heading.html' import page_heading %}

{% extends "_base_page.html" %}
{% block page_title %}
  Digital Marketplace admin
{% endblock %}

{% block content %}
<div class="page-container">

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        {% if message['no_service'] %}
          {% set displayed_message = "Could not find a service with ID: {}".format(message['no_service']) %}
        {% elif message['api_error'] %}
          {% set displayed_message = "Error trying to retrieve service with ID: {}".format(message['api_error']) %}
        {% endif %}
        {%
          with
          message = displayed_message,
          type = "destructive" if category == 'error' else "success"
        %}
          {% include "toolkit/notification-banner.html" %}
        {% endwith %}
      {% endfor %}
    {% endif %}
  {% endwith %}
  {%
    with heading = "Admin"
  %}
    {% include "toolkit/page-heading.html" %}
  {% endwith %}

  {% if current_user.has_role('admin') or current_user.has_role('admin-ccs-category') %}
      <form action="{{ url_for('.find') }}" method="get" class="question">
          <label class="question-heading" for="service_id">Find a service by service ID</label>
          <p class='hint'>
            eg 1234567890123456
          </p>
          <input type="text" name="service_id" id="service_id" class="text-box">
          <input type="submit" value="Search" class="button-save">
      </form>
    
      <form action="{{ url_for('.find_supplier_services') }}" method="get" class="question">
          <label class="question-heading" for="supplier_id_for_services">Find services by supplier ID</label>
          <p class='hint'>
            eg 54321
          </p>
          <input type="text" name="supplier_id" id="supplier_id_for_services" class="text-box">
          <input type="submit" value="Search" class="button-save">
      </form>
    
      <form action="{{ url_for('.find_supplier_users') }}" method="get" class="question">
          <label class="question-heading" for="supplier_id_for_users">Find users by supplier ID</label>
          <p class='hint'>
            eg 54321
          </p>
          <input type="text" name="supplier_id" id="supplier_id_for_users" class="text-box">
          <input type="submit" value="Search" class="button-save">
      </form>
    
      <form action="{{ url_for('.find_suppliers') }}" method="get" class="question">
        <label class="question-heading" for="supplier_name_prefix">Find suppliers by name prefix</label>
        <p class="hint">
          eg searching for c would give all suppliers starting with c
        </p>
        <input type="text" name="supplier_name_prefix" id="supplier_name_prefix" class="text-box">
        <input type="submit" value="Search" class="button-save">
      </form>
  {% endif %}

{% with items = [
    {
        "body": "View G-Cloud 7 statistics",
        "link": "/admin/statistics/g-cloud-7",
        "title": "G-Cloud 7 statistics"
    }
]
%}
{% include "toolkit/browse-list.html" %}
{% endwith %}

</div>
{% endblock %}
